$def with (homestay, month)
$code:
    h = homestay
    c = Calendar()
    m = c.monthdatescalendar(month.year, month.month)
    rooms = homestay.room_set
    
$def available_rooms(d):
    $if d == today():
        <td class="today">
    $elif d < today():
        <td class="passed">
    $elif d > today():
        <td class="future">
    <div class="date_label">$d.day</div>
    <div class="room_list">
    $for r in h.available_rooms(d):
        <a class="available_room"
           href="/$:r.key()/$:{strftime(d, '%Y%m%d')}">$:r.name</a><br/>
    </div>

<!DOCTYPE HTML PUBLIC '-//W3C//DTD HTML 4.01//EN' 'http://www.w3.org/tr/html4/strict.dtd'> 
<html lang="zh-tw"> 
<head><title>$:{h.name}訂房系統</title>
<link rel="stylesheet" href="/css/homestay.css"/>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8"> 
</head>
<body>
<div id="topbar">
    <span id="homestay_name">$:{h.name}訂房系統</span>
    <span id="help">說明</span>
</div>
<div id="left_pane">
<div class="label"><label>房型</label></div>
<div class="subcontent">
$for r in h.room_set:
    $:{r.name}<br/>
    平日：$r.price<br/>
    假日：$r.holiday_price<br/><br/>

</div>
<div class="label">聯絡方式</div>
<div class="subcontent">
$:h.phone<br/>
$:h.address<br/>
$:h.email<br/>
$:h.blog<br/>

</div>
</div>
<div id="content">
  <table id="calendar">
  <tr id="calendar_operation">
      <td colspan="7">
      <a class="operation_button" href="/$:h.key()">今天</a>
      <a class="operation_button"
         href="$:h.last_month_index_path(month)">&lt;</a>

      <a class="operation_button"
         href="$:h.next_month_index_path(month)">></a>
      <label>$:month.year 年 $:month.month 月</label>
      </td>
  </tr>
  <tr id="week_label">
  <td>一</td><td>二</td><td>三</td><td>四</td>
  <td>五</td><td class="saturday">六</td><td class="sunday">日</td>
  </tr>
  $for w in m:
      <tr class="week">
      $for d in w:
          $:available_rooms(d)
      </tr>
  </table>
</div>
</body>
</html>
