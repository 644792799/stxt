$def with (reservation)
$code:
    r = reservation.room
    h = r.homestay
    rooms = h.room_set

<!DOCTYPE HTML PUBLIC '-//W3C//DTD HTML 4.01//EN' 'http://www.w3.org/tr/html4/strict.dtd'> 
<html lang="zh-tw"> 
<head><title>$:{h.name}訂房系統</title>
<link rel="stylesheet" href="/css/homestay.css"/>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8"> 
</head>
<body>
<div id="topbar">
    <span id="homestay_name">$:{h.name}訂房系統</span>
    <span id="help">說明</span>
</div>
<div id="form_content">
<form method="post" action="/rooms/$:r.key()/reservations/new">
  <table class="form">
    <tr><th colspan="2">訂房資料</th></tr>

    <tr><td>房間</td>
        <td><input type="text" readonly="true"
                   value="$:reservation.room.name"/>
            <input name="room" type="hidden" 
                   value="$:reservation.room.key()"/>
    </td></tr>

    <tr><td>訂房日期</td>
        <td><input name="date" type="text" readonly="true"
                   value="$:reservation.date"/>
    </td></tr>

    <tr><td>姓名</td>
        <td><input name="name" type="text" 
                   value="$:reservation.name"/>
    </td></tr>

    <tr><td>聯絡電話</td>
        <td><input name="phone" type="text"
                   value="$:reservation.phone"/>
    </td></tr>

    <tr><td>電子郵件</td>
        <td><input name="email" type="text"
                   value="$:reservation.email"/>
    </td></tr>


    <tr><td>訂單日期</td>
        <td><input name="create_date" type="text" readonly="true"
                   value="$:reservation.create_date"/>
    </td></tr>

    <tr><td colspan="2">備註</td></td></tr>
    <tr><td colspan="2">
        <textarea name="coment">$:reservation.comment</textarea>
    </td></tr>

    <tr><td><input type="submit" value="建立"/></td><td></td></tr>
  </table>
</form>
</div>
</body>
</html>


