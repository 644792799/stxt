資料庫管理簡要說明
------------------

1.訂有「地方稅資訊平台稅務主機及資料庫管理作業辦法」。

1.1.

系統人員欲申請或註銷存取資料庫帳號時需填具
「資料庫帳號(權限)異動申請表」陳核。

1.2.

外單位因處理異常而需存取本局資料庫時，
由本局系統人員填寫「地方稅平台使用申請單」，
經陳核後，交由資料庫管理員配賦帳號密碼，使用完畢立即停用或註銷其帳號。

1.3.

系統人員執行結構化查詢語言之異動指令需填具
「稅務資料庫使用異動指令申請表」，
於臨場作業管制區機台執行，異動權限當日移除。

1.4.

系統人員需將資料庫相關資料匯出或匯入，
應先填寫「資料庫資料表匯出/匯入申請表」陳核後，
由資料庫管理員執行資料匯出匯入作業。

1.5.資料庫使用及授權情形稽核機制：

1.5.1.

自行開發「資料庫自動監控系統」每日執行監控資料庫使用及授權情形。

1.5.2.

自行開發之「資料庫自動監控系統」
每日17；30時自動移除使用者資料庫帳號修改權限。

1.5.3.

自行開發之「資料庫每日檢核」功能，
自動檢查各帳號是否有逾3個月未更新密碼及其他異常情形，
並於每月列印「使用者帳號及使用情形」報表陳核。

1.5.4.

資料庫管理人員每季產出「資料庫帳號權限配賦清單」，
會系統人員檢視所屬權限，據以清理權限。

1.5.5.

自行開發「資料庫使用者稽核系統」
產出「稅務資料庫使用異動指令稽核報表」，
與使用者填具之「稅務資料庫使用異動指令申請表」
稽核是否有逾越權限異動情形。

1.5.6.

自行開發資料庫管理員操作系統，透過可稽核管理介面，
於DBA操作資料庫時，可稽核管理介面會建立相關操作紀錄，
並複製至股長、科長的電腦，以利事後稽核管理員行為。

2.資料庫異常監控及處理相關作業

2.1.

自行開發「資料庫自動監控系統」每日執行資料庫異常監控作業，
並將檢查結果註記於自動產出之「資料庫每日檢查表」陳核。

2.1.1.檢查alert.log是否異常

2.1.2.檢查 DB 主機磁碟機空間是否異常

2.1.3.檢查Table, Index 的有效情況是否異常

2.1.4.檢查SGA 使用情形是否異常

2.1.5.檢查資料庫的備份模式是否異常

2.1.6.自動檢查檢查資料庫中各 Table 及 Index 是否置放於正確的 TableSpace。

2.1.7.檢查 3 個月前的 batchlog 是否備出及是否異常

2.2.建置「資料庫專業監控系統」即時監控資料庫服務狀態

2.2.1.

當資料庫無法連線時將錯誤訊息傳送給設定之資料庫管理員。

2.2.2.

針對資料庫是否有鎖定狀況提供即時監控，
並將執行中的SQL語法，透過電子郵件通報機制。

2.2.3.

將執行中SQL設定「可等待的時間」
當發生等待事件且超過所設定的秒數時以電子郵件通報。

2.2.4.

利用「資料庫專業監控系統」當資料庫背景程式沒有啟動時，
系統會透過電子郵件通報機制傳送給資料庫管理員，
監控系統也提供設定，可自動啟動資料庫。

2.2.5.

當資料庫發生異常時需填具「資料庫異常處理申請表」，
並將處理結果填具「資料庫異常處理報告書」陳核。

3.資料庫表格空間檢核管理及效能調校作業

3.1.

本局稅務資料庫表格空間為 local management， extent 大小統一為4MB，
為配合 db block 8K 格式，表格空間採用JFS2 格式，
表格空間不採用自動增長方式，datafile 大小以不超過 5GB為原則。

3.2.

自行開發「資料庫自動監控系統」，
自動檢核資料庫表格空間使用率是否超過90%。

當資料庫表格空間不足時，
資料庫管理員需填具「資料庫異常處理申請表」核准後，
由管理員手動加大表格空間，
並將處理結果填具「資料庫異常處理報告書」陳核。
【99年未發生資料庫表格空間不足情形】

3.4.表格空間設定調校

3.4.1.

透過自行開發之「資料庫自動監控系統」
每月產製「資料庫表格空間使用率報表」陳核 e-mail 通報相關人員，
供每季資料庫效能調校參考。

3.4.2.

利用自行開發之「資料庫自動監控系統」
每季產製「資料庫成長分析報表」，供每季資料庫調校時調整參考。

3.5.

利用自行開發之「資料庫自動監控系統」，
每月產製「暫存空間使用狀況報表」，供每季資料庫調校時調整參考

3.6.

為維持資料庫高效能服務，
委由資料庫專業維護廠商每季辦理效能調教作業。

4.資料庫備份策略與監控及回復相關作業紀錄

4.1.訂有「檔案備援暨媒體管理要點」。

4.2.

稅務資料庫透過「VERITAS NetBackup」備份系統，
設定排程每日執行全備份，週一至週五自動備份於磁帶櫃，
週日備援二份異地存放於第一媒體室及第二媒體室，
另於每月28日備援一份異地存放玉里分局。

4.3.

每日零時設定排程將資料表全部匯出成檔儲存於DB主機，
於線上保留3日，做為線上資料表異常快速回復之用。

4.4.

本局資料庫之tablespace 啟用Recyclebin功能，
可透過此機制立即回復誤刪表格。

4.5.

本局資料庫undo_retention 時間設定為 6 小時，
可透過 Flashback 機制立即復原6小時以內之異動資料。

4.6.

藉由 logminer 機制，在不停機下，
將誤改、誤刪之資料找回相對之 SQL code，再將資料進行回復。

4.7.

每日由主機操作員依「地方稅主機每日檢查表」
第 32 至 35 檢查項檢視備援情況及紀錄，
並列印「備援情形報告表」陳核。

4.8.

按月辦理備份媒體檔案試讀，並列印媒體試讀結果清單陳核。

4.9.

於99年5月25日辦理網路申報資料庫主機異常無法提供服務備援檔案回復作業。

4.10.

於99年10月20辦理資料庫主機異常，
進行資料庫回復作業之災變回復演練，驗證災變後備援媒體之可回復性。

5.資料庫連線安全管理機制及相關作業紀錄

5.1.Listener.log查核

自行開發「資料庫自動監控系統」
每日檢查Listener.log是否有異常IP或異常程式連線。

5.2.

臨場作業管制區電腦設有螢幕側錄監控系統，
且無裝置儲存設備、列印設備，資料庫之查詢、異動作業均需於此區電腦執行。

5.3.

建置 SGS5420 多功能防火牆區隔 DB 主機及 AP 之網路區段，
加強 DB 主機安全管控。
